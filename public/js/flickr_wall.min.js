$(function(){function n(){var e='<img id="loading" src="./img/loading.gif"       style="width:150px;height:150px;" />';$("#images").append(e)}function r(){$("#loading").remove()}function i(){t=t+1;c(t)}function s(){$("#images").html("")}function o(){$("#error_messages").html("")}function u(e){$("#images").append(e)}function a(e){$("#pagination").html(e)}function f(e){var t="";$.each(e.photos.photo,function(e,n){photoLink="http://farm"+n.farm+".staticflickr.com/"+n.server+"/"+n.id+"_"+n.secret+"_q.jpg";largePhotoLink="http://farm"+n.farm+".staticflickr.com/"+n.server+"/"+n.id+"_"+n.secret+"_b.jpg";t+='<a href="'+largePhotoLink+'" target="_blank">';t+='<img title="'+n.title+'" src="'+photoLink;t+='" alt="';t+=n.title+'" />';t+="</a>"});return t}function l(e){console.log(e.photos.pages);pages=e.photos.pages;_htmlString='<div class="pagination"><ul><li><a href="#">&laquo;</a></li>';for(var t=0;t<pages;t++){_htmlString+='<li><a href="#">'+t+"</a></li><li>"}_htmlString+='<li><a href="#">&raquo;</a></li></ul></div>';return _htmlString}function c(t){function c(t){if(t.photos.total==0){$("#error_messages").html("There are no photos for your keywords");r();return}pagination=l(t);htmlString=f(t);r();a(pagination);u(htmlString);e=false}var n=$("#inputtext").val();if(n.length==0){$("#error_messages").html("Please enter some image keywords");r();return}n=n.split(" ");n=n.join("+");var i="b39c9c4bf520689fde7ac982b2a93dce";var s="100";var o="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+i+"&text="+n+"&per_page="+s+"&page="+t+"&format=json&jsoncallback=?";$.getJSON(o,c).fail(function(e,t,n){var i=t+", "+n;$("#error_messages").html("Internal Server Error - Contact me at bcabalo@gmail.com to get this fixed.");r()})}var e=false;var t=1;$("#inputbutton").click(function(){t=1;s();o();n();c(1)});$("#inputtext").keypress(function(e){if(e.which==13){$("#inputbutton").click()}});$(window).scroll(function(){if($(window).scrollTop()==$(document).height()-$(window).height()){if(e==false){e=true;n();i()}}})})
